<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Hợp Đồng Mua Bán Xe Điện</title>
    <style>
      body {
        font-family: "DejaVu Sans", Arial, sans-serif;
        line-height: 1.6;
        font-size: 14px;
        color: #222;
        margin: 40px;
        background-color: #fefefe;
      }
      h1,
      h2 {
        text-align: center;
        text-transform: uppercase;
      }
      .contract-info {
        text-align: center;
        margin-bottom: 30px;
        font-size: 15px;
      }
      .contract-info strong {
        color: #1a73e8;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
      }
      th,
      td {
        border: 1px solid #ccc;
        padding: 10px;
        vertical-align: top;
      }
      th {
        background-color: #e8f0fe;
        text-align: left;
      }
      .section-title {
        margin-top: 30px;
        font-weight: bold;
        font-size: 18px;
        text-transform: uppercase;
        border-bottom: 2px solid #1a73e8;
        padding-bottom: 4px;
        color: #1a73e8;
        margin-bottom: 16px;
      }
      .highlight {
        font-weight: bold;
        color: #1a73e8;
      }
      .amount {
        font-weight: bold;
        color: #d93025;
        font-size: 15px;
      }
      .vehicle-card {
        border: 1px solid #ccc;
        background-color: #f9f9f9;
        padding: 12px 16px;
        margin-bottom: 16px;
        border-radius: 8px;
      }
      .vehicle-card p {
        font-weight: bold;
        color: #1a73e8;
        margin-bottom: 8px;
      }
      .vehicle-card ul {
        list-style: none;
        padding-left: 0;
      }
      .vehicle-card ul li {
        margin-bottom: 4px;
        margin-top: 6px;
      }
      .note {
        margin-top: 10px;
        font-style: italic;
        color: #333;
        background-color: #fff3cd;
        padding: 8px;
        border-left: 4px solid #ffeeba;
        border-radius: 4px;
      }
      .signature-table {
        margin-top: 40px;
      }
      .signature-table td {
        height: 80px;
        text-align: center;
        vertical-align: bottom;
      }
    </style>
  </head>
  <body>
    <h2
      style="text-align: center; text-transform: uppercase; margin-bottom: 10px"
    >
      CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM<br />
      <span style="text-transform: none; font-weight: normal"
        >Độc Lập – Tự Do – Hạnh Phúc</span
      >
    </h2>
    <h1>Hợp Đồng Mua Bán Xe Điện</h1>
    <p class="contract-info">
      Số hợp đồng: <strong>{{contractNumber}}</strong><br />
      Địa điểm: {{location}}, Ngày {{day}} tháng {{month}} năm {{year}}
    </p>

    <div class="section-title">ĐIỀU 1: THÔNG TIN CÁC BÊN</div>
    <table class="vehicle-card">
      <tr>
        <th style="width: 50%">Bên A (Bên bán)</th>
        <th>Bên B (Bên mua)</th>
      </tr>
      <tr>
        <td>
          <strong class="highlight">Tên đại lý:</strong>
          {{dealership.name}}<br />
          <strong class="highlight">Địa chỉ:</strong>
          {{dealership.address}}<br />
          <strong class="highlight">Điện thoại:</strong>
          {{dealership.phone}}<br />
          <strong class="highlight">Mã số thuế:</strong>
          {{dealership.tax_code}}<br />
          <strong class="highlight">Người đại diện:</strong>
          {{dealership.representative}}
        </td>
        <td>
          <strong class="highlight">Họ và tên:</strong>
          {{customer.full_name}}<br />
          <strong class="highlight">Địa chỉ:</strong> {{customer.address}}<br />
          <strong class="highlight">Điện thoại:</strong>
          {{customer.phone}}<br />
          <strong class="highlight">Email:</strong> {{customer.email}}
        </td>
      </tr>
    </table>

    <div class="section-title">ĐIỀU 2: THÔNG TIN XE VÀ GIÁ BÁN</div>
    {{#each vehicles}}
    <div class="vehicle-card">
      <p>Xe {{index}}: {{name}} (Màu {{color}})</p>
      <ul>
        <li>
          Giá: <span class="amount">{{formatCurrencyVND unit_price}} VNĐ</span>
        </li>
        <li>Số lượng: {{quantity}}</li>
        <li>
          Khuyến mãi: {{#if promotion}} {{promotion.name}} ({{promotion.type}})
          {{else}} Không có {{/if}}
        </li>
        <li>
          Phụ kiện: {{#if accessories.length}} {{#each accessories}}{{name}}
          (x{{quantity}}){{#unless @last}}, {{/unless}}{{/each}} {{else}} Không
          có {{/if}}
        </li>
        <li>
          Tùy chọn thêm: {{#if options.length}} {{#each options}}{{name}}
          ({{formatCurrencyVND price}}){{#unless @last}}, {{/unless}}{{/each}}
          {{else}} Không có {{/if}}
        </li>
        <li>
          <strong>Tổng giá trị:</strong>
          <span class="amount">{{formatCurrencyVND final_amount}}</span>
        </li>
      </ul>
    </div>
    {{/each}}

    <p>
      <strong>Phương thức thanh toán:</strong> {{paymentMethodText}}<br />
      <strong>Đã thanh toán:</strong>
      <span class="amount">{{formatCurrencyVND paidAmount}} VNĐ</span><br />
      <strong>Còn lại:</strong>
      <span class="amount">{{formatCurrencyVND remainingAmount}} VNĐ</span>
    </p>

    <div class="section-title">ĐIỀU 3: NHẬN XE</div>
    <p>
      Xe sẽ được giao tại địa chỉ đại lý: {{dealership.address}}<br />
      Hoặc giao xe đến địa chỉ: {{deliveryAddress}}<br />
      Ngày giao xe dự kiến: {{deliveryDate}}<br />
      Khách hàng chịu trách nhiệm nhận xe và các giấy tờ liên quan.
    </p>

    <div class="section-title">ĐIỀU 4: BẢO HÀNH VÀ TRÁCH NHIỆM</div>
    <ol>
      <li>Bên A cam kết cung cấp bảo hành chính hãng theo quy định.</li>
      <li>Bên B có trách nhiệm sử dụng xe đúng hướng dẫn và bảo quản xe.</li>
      <li>Xe chỉ hoạt động tốt khi sử dụng pin và thiết bị sạc chính hãng.</li>
      <li>Mọi tranh chấp sẽ được giải quyết thông qua đàm phán, hòa giải.</li>
    </ol>

    <div class="section-title">ĐIỀU 5: CHUYỂN RỦI RO VÀ QUYỀN SỞ HỮU</div>
    <p>
      Toàn bộ quyền sở hữu, rủi ro và lợi ích liên quan đến xe sẽ chuyển giao
      cho Khách hàng khi xe được bàn giao hoặc khi Khách hàng thanh toán đầy đủ
      giá trị hợp đồng.
    </p>

    <div class="section-title">ĐIỀU 6: BẢO VỆ DỮ LIỆU CÁ NHÂN</div>
    <p>
      Khách hàng đồng ý cho Bên bán xử lý dữ liệu cá nhân liên quan đến việc vận
      hành, bảo trì và các tính năng thông minh của xe theo quy định pháp luật
      hiện hành.
    </p>

    <div class="section-title">ĐIỀU 7: CÁC ĐIỀU KHOẢN KHÁC</div>
    <ol>
      <li>Hợp đồng có hiệu lực kể từ ngày ký.</li>
      <li>Mọi thay đổi hợp đồng phải được thỏa thuận bằng văn bản.</li>
      <li>Hợp đồng được lập thành 2 bản có giá trị pháp lý như nhau.</li>
    </ol>

    {{#if notes}}
    <p class="note"><strong>Ghi chú thêm:</strong> {{notes}}</p>
    {{/if}}

    <table class="signature-table">
      <tr>
        <th style="width: 50%; text-align: center">ĐẠI DIỆN BÊN A</th>
        <th style="text-align: center">ĐẠI DIỆN BÊN B</th>
      </tr>
      <tr>
        <td>(Ký, ghi rõ họ tên)</td>
        <td>(Ký, ghi rõ họ tên)</td>
      </tr>
    </table>
  </body>
</html>
